# **Чек-лист анализа конфигурации для перевода СП 1С на ОС Linux**

## **Предварительный анализ:**

- [ ] **База 1С не использует СУБД Microsoft SQL Server**
- [ ] **Используемые компоненты поддерживают ОС Linux x64** (ПодключитьВнешнююКомпоненту / AttachAddIn, ОбщегоНазначения.ПодключитьКомпонентуИзМакета)
- [ ] **COMОбъект / COMObject**
- [ ] **ПолучитьCOMОбъект / GetCOMObject**
- [ ] **Почта / Mail** - для доступа к почтовой системе, установленной на компьютере
- [ ] **ИнтернетСоединение / InternetConnection** - доступен только с установленным Internet Explorer версии 5.0 или выше
- [ ] **Выполнить / Execute** - убедиться, что код будет работать на ОС Linux (отсутствуют COM, корректные пути). Для поиска удобно использовать регулярные выражения: `[^\.]\bВыполнить\(`
- [ ] **КомандаСистемы / System** - вызывает на исполнение команду операционной системы. Проверить наличие прав для пользователя `usr1cv8`. Убедиться, что во внешние приложения передаются корректные пути с учетом регистра и разделителей.
- [ ] **ЗапуститьПриложение / RunApp** - запуск внешнего приложения, либо открытие файла. Проверить наличие прав для пользователя `usr1cv8`. Убедиться, что во внешние приложения передаются корректные пути с учетом регистра и разделителей. Если в качестве вызываемого приложения указывается скрипт (например, *.sh), то необходимо проверить:
    - **Кодировку**: UTF-8
    - **Права на исполнение**:
        - Добавить права можно перед вызовом скрипта командой: `ЗапуститьПриложение("chmod 740 " + ФайлСкрипта,, Истина)`
    - **Формат конца строк для Unix**:
        - Новая строка в Windows: `\r\n` = CR (Carriage Return = Возврат каретки) + LF (Line Feed = Перевод строки)
        - Новая строка в Unix: `\n` = LF
    - Если скрипт создается программно через `ЗаписьТекста`, то указываем необязательные параметры, т.к. параметр `КонвертируемыйРазделительСтрок`, определяющий разделение строк в файле, имеет значение по умолчанию: CR + LF: `ЗаписьТекста = Новый ЗаписьТекста(ФайлСкрипта, "UTF-8", Символы.ПС, Ложь, Символы.ПС)`
- [ ] **ФайловаяСистема.ЗапуститьПрограмму / ОбщегоНазначенияКлиентСервер.ЗапуститьПрограмму** - Проверить наличие прав для пользователя `usr1cv8`. Убедиться, что во внешние приложения передаются корректные пути с учетом регистра и разделителей.
- [ ] **Работа с криптографией**:
    - [ ] Запросить установленное ПО на сервере
    - [ ] Проверить флаг "Подписывать на сервере" в настройках базы 1С `e1cib/app/ОбщаяФорма.НастройкиЭлектроннойПодписиИШифрования`
    - [ ] Для взаимодействия с модулями криптографии в ОС Windows используется Microsoft CryptoAPI, а при работе в ОС Linux или macOS — интерфейс КриптоПРО CSP (`Новый МенеджерКриптографии`)
- [ ] **Если используются SSH ключи** (например, работа с git), не забывать копировать актуальные SSH ключи со старого сервера приложений 1С (`E:\Users\usr1cv8\.ssh\`) на новый сервер приложений 1С на ОС Linux (`/home/usr1cv8/.ssh/`), в том числе и файл `known_hosts`. Иначе первую команду необходимо выполнять интерактивно в консоли под `usr1cv8`, чтобы создался файл `/home/usr1cv8/.ssh/known_hosts` — отключение подтверждений (например, "yes/no/..." при обращении к git с помощью SSH ключа)
- [ ] **Уточнять какие сетевые каталоги используются в УРБД для переводимой базы 1С** (для дальнейшего монтирования каталогов на сервере с видом пути, как у сетевого каталога Windows)

## **Анализ перед миграцией (инфраструктура получена и настроена):**

- [ ] **Работа с криптографией**:
    - [ ] В случае использования, проконтролировать, что новые сервера для разработки и прод настроены для работы с криптографией.
- [ ] **Значения констант и реквизитов, содержащих пути**. Например, сетевые каталоги или служебные каталоги ОС Windows (см. особенности заполнения поля путь для Linux)
- [ ] Изображения в форматах WMF и EMF (метафайлы Windows) следует заменить на растровые, например PNG или JPG
- [ ] **Если используются SSH ключи** (например, работа с git), не забывать копировать актуальные SSH ключи со старого сервера приложений 1С (`E:\Users\usr1cv8\.ssh\`) на новый сервер приложений 1С на ОС Linux (`/home/usr1cv8/.ssh/`), в том числе и файл `known_hosts`. Иначе первую команду необходимо выполнять интерактивно в консоли под `usr1cv8`, чтобы создался файл `/home/usr1cv8/.ssh/known_hosts` — отключение подтверждений (например, "yes/no/..." при обращении к git с помощью SSH ключа)
    - **Дополнительно**: проконтролировать копирование SSH ключей на новые сервера для разработки и продуктивы.
- [ ] **Уточнять какие сетевые каталоги используются в УРБД для переводимой базы 1С** (для дальнейшего монтирования каталогов на сервере с видом пути, как у сетевого каталога Windows)
    - **Дополнительно**: проконтролировать, что смонтированы все нужные каталоги на новые сервера для разработки и продуктивы.
- [ ] **Поиск мест, откуда вызываются COM-соединения к базе 1С** (для изменения путей в зависимых системах при переводе базы на ОС Linux)
    - **Дополнительно**: проконтролировать корректировку найденных настроек во внешних базах (корректировку с учетом нового расположения БД на СП 1С Linux).
